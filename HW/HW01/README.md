# Машинное обучение — Д/з №1 — Части 1 и 2

Автор: _Дмитрий Д. Никитин, ВШЭ, маг-ра Искусственный Интеллект, 1 курс_

-------

## Запуск Streamlit-приложения

```
pip install streamlit
```
```
streamlit run app.py
```


## Части работы

Данная работа содержит следующие компоненты:
1. `ipynb`-ноутбук с исследованием
2. `pkl`-файл с лучшей моделью
3. `app.py` — Streamlit-приложение
4. Отчёт `README` c результатами

## Что было сделано

- Этап 1 — **EDA и предобработка**
    - изучены и обработаны типы данных, пропуски и дубликаты
    - удалён признак `torque` из-за сложности его обработки, а также `name` из-за слишком большого количества уникальных категорий
    - проведён анализ корреляций и визуализаций распределений
  
- Этап 2 — **Модели на вещественных признаках**
    - Построены модели:
        - Linear Regression
        - Standardized Linear Regression
        - Lasso 
        - Ridge (с подбором `alpha`)
        - ElasticNet (с подбором `alpha` и `l1_ratio`)
    - Для всех моделей были посчитаны метрики качества

- Этап 3 — **Работа с категориальными признаками**
    - применено OHE с `drop=first`
    - объединены числовые и категориальные признаки
    - обучены новые версии моделей Ridge и ElasticNet на расширенном наборе признаков

- Этап 4 — **Кросс-валидация финальных моделей**

- Этап 5 — **Streamlit-приложение**
    - Создано Streamlit-приложение, включающее:
        - отображение основных графиков EDA
        - загрузку CSV или ручной ввод признаков
        - применение модели к пользовательским данным
        - визуализацию важности признаков (веса модели)

## Какие результаты были получены

| Модель               | $R^2$ (test) | MSE (test)           | Business metric (±10%) |
|---------------------|-----------|-----------------------|--------------------------|
| Linear Regression    | 0.5941    | 2.33e11               | 0.227                    |
| Lasso                | 0.5941    | 2.33e11               | 0.227                    |
| ElasticNet           | 0.5615    | 2.52e11               | 0.247                    |
| Ridge + OHE          | **0.6150** | **2.21e11**          | **0.252**                |

Интерпретация: Видно, что добавление категориальных признаков позволило улучшить результаты.

## Что дало наибольший прирост качества
- Добавление категориальных признаков
- Использование Ridge на полном наборе признаков

## Что сделать не удалось и почему
- Не удалось добиться зануления коэффициентов с помощью Lasso, так как набор признаков небольшой и все признаки информативны.
- Не получилось обработать признак `name`. — Не хватило времени. Но признак был бы полезным, т.к. некоторые модели машин стоят дорого из-за своего бренда.

## Оценка разработанного сервиса

### Что получилось хорошо:
- интуитивный интерфейс
- поддержка CSV и ручного ввода
- наличие EDA прямо в приложении

### Что можно улучшить:
- добавить больше графиков в EDA (сейчас только основные)
- улучшить визуальный стиль (цветовые темы)

## Ограничения модели
- Модель чувствительна к выбросам в числовых признаках.
- Бизнес-метрика остаётся низкой.
- Модель не учитывает текстовый признак `name`.

## Планы на следующую итерацию
1. Добавить обработку признака `name`.
2. Добавить автоматическое определение выбросов.
3. Расширить EDA внутри Streamlit.

$\delta$
